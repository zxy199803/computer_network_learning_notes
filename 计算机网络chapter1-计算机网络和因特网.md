# 1计算机网络和因特网

## 什么是互联网

### 1.1基本术语和概念

#### 1.1.1从具体构成描述因特网

世界范围的计算机网络，所有设备称为主机(host)或端系统。

端系统通过通信链路和分组交换机连接到一起。

链路传输速率单位比特/秒（bit/s或bps)

端系统发送数据时将数据分段，并为每段加上首部字节，这样的信息包称为分组（类似卡车）。

分组交换机（类似交叉口）有路由器用于网络核心中，链路层交换机用于接入网中

端系统通过因特网服务商(ISP)接入因特网

端系统、分组交换机和其他部件运行一系列协议，协议控制因特网中信息的接收和发送。TCP（Transmission Control Protocol，传输控制协议），IP(Internet Protocol，网际协议)，IP协议定义了在路由器和端系统之间发送和接收的分组格式。HTTP用于web,SMTP用于电子邮件

#### 1.1.2从服务描述因特网-因特网是为应用程序提供服务的基础设施

应用设计多个相互交换数据的端系统，称为分布式应用程序。因特网应用程序运行在端系统上。

将因特网描述为应用程序的平台，运行在不同端系统上的软件需要互相发送数据。

与因特网相连的端系统提供了一个套接字接口(socket interface)，该接口规定了在一个端系统上的程序请求因特网向另一个端系统上的程序交付数据的当时。因特网套接字接口是一套发送程序必须遵循的规则集合。类比（写信后需要贴邮票，放进邮筒等）。

#### 1.1.3协议

涉及两个或多个通信实体的所有活动都受协议的制约

协议（protocol）定义了在两个或多个通信实体之间交换的报文的格式和顺序，以及报文发送和/或接收一条报文或其他事件所采取的动作。

定义了报文格式和顺序，以及动作

掌握计算机网络领域知识就是理解网络协议的构成、原理和工作方式。

## 网络基本硬件和软件

### 1.2网络边缘-端系统和网络应用

端系统也称为主机(host)，因为它们容纳运行应用程序。

主机分为客户端和服务器

#### 1.2.1接入网

接入网将端系统物理连接到边缘路由器(edge router)的网络。

##### 家庭接入

宽带住宅接入方式：如数字用户线(DSL)，通过电话线，分配器吧数字信号和电话信号隔开，数字信号转发到DSL调整解套器，0-4kHz电话，4-50kHz上行数据，50kHz-1MHz下行数据，DSL标准定义了多个传输速率

电缆因特网接入利用有线电视公司现有的有线电视基础设施。用户共享上下行信道

光纤到户（FIber to the Home FTTH）。光纤分布体系结构，主动光纤网络(AON)；被动光纤网络(PON)，

##### 企业（和家庭接入）：以太网和wifi

局域网（LAN）将端系统连接到边缘路由器

##### 广域无线接入：3G和LTE

通过基站发送和接收分组，LTE（长期演进的缩写）

#### 1.2.2物理媒体

导引型媒体-电波沿固体媒体前行，如光缆、双绞铜线、同轴电缆

非导引型媒体-电波在空气或外层空间传播

### 1.3计算机网络的核心-链路和交换机

由互联因特网端系统的分组交换机和链路构成的网状网络，通过网络链路和交换机移动数据有两种基本方法：分组交换（packet switching）和电路交换(circuit switching)

#### 1.3.1分组交换

端系统彼此交换报文(message)，报文可执行控制功能，可包含数据。将长报文划分为较小的数据块，称为分组（packet）,每个分组通过通信链路和分组交换机（主要有路由器和链路层交换机两类）传送。

##### 存储转发传输

多数分组交换机在链路输入端使用存储转发传输机制，必须接收到整个分组后再输出

##### 排队时延和分组丢失
每台分组交换机有多条链路与之相连，分组交换机具有一个输出缓存（也称输出队列），用于存储路由器准备发往链路的分组。除了存储转发时延外，分组还有输出缓存的排队时延。缓存空间有限，可能出现分组丢失（丢包）

##### 转发表和路由选择协议

每个端系统具有一个称为IP地址的地址，每台路由器具有一个转发表，用于将地址映射为输出链路。因特网有一些特殊的路由选择协议用于自动设置转发表

#### 1.3.2电路交换

在电路交换网络（circuit switching）中，在端系统通信会话期间，预留了端系统间沿路径所需的资源（缓存，链路传输速率）。像需要预定的餐馆。传统的电话网络是电路交换网络的例子

##### 复用

链路中的电路通过频分复用（Frequency-Division Multiplexing，FDM）或时分复用（TDM）实现。

FDM链路的频谱由所有连接共享，连接期间链路为每条连接专用一个频段，该频段的宽度称为带宽（band width）。

TDM链路时间被划分为固定期间的帧，每个帧被划分为固定数量的时隙。网络在每个帧中为该连接指定一个时隙，供其单独使用。传输速率=帧速率*一个时隙的比特数量。

##### 与分组交换的对比

电路交换不考虑需求，预先分配了传输链路的使用，已分配而不需要的链路时间未被使用

分组交换按需分配链路使用。趋势朝着分组交换的方向发展

#### 1.3.3网络的网络

端系统通过因特网服务商(ISP)接入因特网。ISP自身必须互联。

网络结构1 单一的全球ISP互联所有接入ISP

网络结构2 多个全球ISP和接入ISP。全球ISP之间互联

网络结构3 多个竞争的第一层ISP，多个竞争的区域ISP，

网络结构4 接入ISP 区域ISP 第一层ISP PoP 多宿 对等 IXP

网络结构5 接入ISP 区域ISP 第一层ISP PoP 多宿 对等 IXP 内容提供商网络

## 端到端吞吐量和时延的定量模型

### 1.4分组交换网中的时延、丢包、吞吐量

#### 1.4.1时延概述

节点处理时延、排队时延、传输时延、传播时延

##### 时延的类型

处理时延：包括检查分组首部，决定该分组导向何处、检查比特级别的差错

排队时延：分组在链路上等待传输

传输时延：将所有分组推向链路的时间。路由器推出分组所需时间，是分组长度和链路传输速率的函数，与两台路由器间的距离无关，

传播时延：从链路起点到路由器B传播所用时间

#### 1.4.2排队时延和丢包

排队时延对不同的分组可能不同，常使用统计量度量（平均排队时延、方差等）

流量强度=到达队列的平均速率/传输速率，流量强度不能大于1

队列到达的过程可能是随机的，随着流量强度接近于1，平均排队时延迅速增加

##### 丢包

排队容量是有限的，没有地方存储路由器将丢弃该分组。丢失的分组可能基于端到端的原则重传

#### 1.4.3端到端时延

从源到目的地的总时延。

#### 1.4.4计算机网络中的吞吐量

从主机A到主机B传送大文件，瞬时吞吐量：B接收到该文件的速率。平均吞吐量：文件大小/接收时间。

吞吐量取决于数据流过的链路的传输速率、干扰流量

## 体系结构原则

### 1.5协议层次及其服务模型

只要该层对其上面层提供相同服务，并使用来自下面层的相同服务，当某层变化时其他部分保持不变。

#### 1.5.1分层的体系结构

##### 协议分层

应用层：网络应用程序及它们的应用层协议，包括许多协议：HTTP（web文档的请求和传输），SMTP（电子邮件报文传输），FTP（端系统间的文件传送），域名系统（DNS，将www.ietf.org端系统名字变为32比特网络地址）。应用层协议分布在多个端系统上，一个端系统的应用程序使用协议与另一个端系统应用程序交换分组信息（报文（message））。

运输层：在应用程序端点之间传送应用层报文。因特网中有两种运输协议：TCP，UDP。TCP向它的应用程序提供了面向连接的服务，包括了应用层报文向目的地的确保传递和流量控制（发送方/接收方速率匹配）。TCP也将长报文划分为短报文，提供拥塞控制机制（网络拥塞时抑制其传输速率）。UDP向它的应用程序提供无连接服务，是不提供不必要服务的服务，没有可靠性、流量控制、拥塞控制。把运输层的分组称为报文段（segment）

网络层：负责将数据报（datagram）的网络层分组从一台主机移动到另一台主机。在一台源主机中的因特网运输层协议（TCP或UDP）向网络层递交运输层报文段和目的地地址。因特网的网络层包括网际协议IP，该协议定义了在数据报中的各个字段以及端系统和路由器如何作用于这些字段。IP仅有一个，所有具有网络层的因特网组件必须运行IP。网络层也包括决定路由的路由选择协议。通常简称为IP层

链路层：把链路层分组称为帧（frame），链路层将整个帧从一个网络元素移动到邻近的网络元素。在每个节点，网络层将数据报下传给链路层，链路层沿着路径将数据报传递给下一个节点，在该节点链路层将数据上报给网络层。链路层提供的服务取决于应用于该链路的特定链路层协议。TCP提供一个端系统到另一个端系统的可靠交付，期间通常需要经过几条链路。网络层将受到来自每个不同链路层协议的不同服务。

物理层：将帧中的一个个比特从一个节点移动到下一节点，该层协议是链路相关的，且与链路的实际传输媒体相关。如以太网具有许多物理层协议（关于双绞铜线、同轴电缆、光纤的），不同场合跨越链路移动一个比特以不同方式进行。

##### OSI模型

开放系统互联（OSI）模型，7层：应用层、表示层、会话层、运输层、网络层、数据链路层、物理层。表示层使通信的应用程序能够解释交换数据的含义，服务包括数据压缩、数据加密、数据描述。会话层提供数据交换的定界和同步功能，包括了建立检查点和恢复方案的方法。

因特网将表示层和会话层提供的服务留给开发者，如果该服务重要，开发者在应用程序中构建该功能。

#### 1.5.2封装

封装（encapsulation），在每一层，一个分组具有两种类型的字段：首部字段和有效载荷字段（payload field），有效载荷通常来自上一层的分组。


## 

## 