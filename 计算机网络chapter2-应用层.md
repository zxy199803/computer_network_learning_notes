# 2应用层

## 定义关键的应用层概念，考察几种网络应用程序

### 2.1应用层协议原理

研发网络应用的核心是写出能够运行在不同的端系统和通过网络彼此通信的程序

#### 2.1.1网络应用程序体系结构

从应用开发者角度，网络体系结构是固定的，为应用程序提供了特定的服务集合。应用程序体系结构由开发者设计。现代网络应用的两种主流体系结构：客户-服务器体系结构，对等（P2P）体系结构。

客户-服务器体系结构中，有一个总是打开的主机称为服务器，服务于来自其他称为客户的主机的请求。客户互相之间不直接通信，服务器具有固定的、周知的地址，称为IP地址。客户总是能够通过向服务器的IP地址发送分组与其联系。采用客户-服务器体系结构的应用有：Web，FTP，Telnet，电子邮件。

P2P体系结构中，对服务器有最小（或）没有依赖，应用程序在间断连接的主机对之间使用直接通信，主机对被称为对等方。采用P2P体系结构的应用有：文件共享（如BitTorrent）、对等方协助下载加速器（如迅雷）、因特网电话和视频会议（如Skype）。P2P体系结构有自扩展性。

#### 2.1.2进程通信

进行通信的实际上是进程（process）而不是程序。进程间通信的规则有端系统上的操作系统确定。关注不同端系统上的进程间通信。两个不同端系统上的进程通过跨越计算机网络交换报文（message）而相互通信。

##### 客户和服务器进程

网络应用程序由成对的进程组成，这些进程通过网络互相发送报文，将一个标识为客户（client），另一个标识为服务器（server）。在一对进程之间的通信会话场景中，发起通信的进程被标识为客户，在会话开始时等待联系的进程是服务器。

##### 进程与计算机网络之间的接口

进程通过称为套接字（socket）的软件接口向网络发送报文和从网络接收报文。套接字也称为应用程序和网络之间的应用程序编程接口（API），开发者可以控制套接字在应用层端的一切，对该套接字在运输层几乎没有控制权（仅限于选择运输层协议，设定运输层参数）。

##### 进程寻址

接收进程需要一个地址，需定义：主机的地址、在目的主机中指定接收进程的标识符。因特网中主机由其IP地址标识。接收主机上的接收进程（具体来说是接收套接字）用目的地端口号（port number）标识，如Web服务器用端口号80标识

#### 2.1.3可供应用程序使用的运输服务

有多种运输层协议，大致从4个方面对应用程序的服务要求进行分类：可靠数据传输、吞吐量、定时、安全性

##### 可靠数据传输

分组在网络中可能丢失，可靠数据传输确保由应用程序的一端发送的数据正确、完全地交付给了另一端。

##### 吞吐量

确保可用吞吐量至少r比特/秒。具有吞吐量要求的应用称为带宽敏感的应用。弹性应用能够根据可用带宽或多或少利用可供使用的吞吐量。

##### 定时

保证时延

##### 安全性

加密、数据完整性和端点鉴别等

#### 2.1.4因特网提供的运输服务

##### TCP服务

TCP服务模型包括面向连接服务和可靠数据传输服务。

面向连接服务：在应用层数据报文流动前，TCP让客户和服务器交换运输层控制信息，称为握手过程。握手后再两个进程的套接字之间建立TCP连接，是全双工的，即连接双方的进程可以在此连接上同时进行报文收发。结束报文发送时，拆除连接。

可靠数据传输服务：通信进程依靠TCP无差错、按适当顺序交付发送数据。依靠TCP将同样的字节流交付给接收方的嵌套字，而没有字节的丢失和冗余。

拥塞控制机制：网络出现拥塞时，会抑制发送进程

TCP无任何加密机制。SSL（安全套接字层）是TCP的强化，在应用层上实现。发送进程向SSL套接字传递明文数据，SSL则加密数据并传递给TCP套接字。

##### UDP服务

仅提供最小服务，是无连接的，两个进程通信前没有握手过程，提供不可靠数据传送服务，没有拥塞控制机制。

##### 不提供的服务

因特网运输协议没有提供吞吐量和定时

#### 2.1.5应用层协议